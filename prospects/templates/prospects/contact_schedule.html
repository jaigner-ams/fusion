{% extends 'prospects/base_prospects.html' %}

{% block title %}{{ title }} - AMS Fusion Prospects{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>Contact Schedule</h1>
    <a href="{% url 'prospects:prospect_list' %}" class="btn btn-secondary">Back to List</a>
</div>

<!-- Date Picker -->
<div class="card mb-4">
    <h5 class="mb-3">Select Date</h5>
    <form method="get" class="row g-3 align-items-end">
        <div class="col-md-4">
            <label for="date" class="form-label">Contact Date</label>
            <input type="date" class="form-control" id="date" name="date" value="{{ selected_date|date:'Y-m-d' }}">
        </div>
        <div class="col-md-4">
            <button type="submit" class="btn btn-primary">Show Contacts</button>
            <a href="{% url 'prospects:contact_schedule' %}" class="btn btn-secondary">Today</a>
        </div>
    </form>
</div>

<!-- Contacts for Selected Date -->
<div class="card">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h4 class="mb-0">Contacts for {{ selected_date|date:"l, F d, Y" }}</h4>
        <span class="badge bg-info fs-6">{{ prospects.count }} contact{{ prospects.count|pluralize }}</span>
    </div>

    {% if prospects %}
        <div class="table-responsive">
            <table class="table table-striped table-hover mb-0">
                <thead>
                    <tr>
                        <th>Lab Name</th>
                        <th>Contact Person</th>
                        <th>Location</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for prospect in prospects %}
                        <tr>
                            <td>
                                <a href="{% url 'prospects:prospect_detail' prospect.pk %}" class="text-white text-decoration-none">
                                    <strong>{{ prospect.lab_name }}</strong>
                                </a>
                            </td>
                            <td>{{ prospect.person_name }}</td>
                            <td>{{ prospect.city }}{% if prospect.city and prospect.state %}, {% endif %}{{ prospect.state }}</td>
                            <td>
                                {% if prospect.status == 'prospect' %}
                                    <span class="badge badge-prospect">Fusion Prospect</span>
                                {% elif prospect.status == 'member' %}
                                    <span class="badge badge-member">Fusion Member</span>
                                {% elif prospect.status == 'declined' %}
                                    <span class="badge badge-declined">Fusion Declined</span>
                                {% endif %}
                            </td>
                            <td>
                                <a href="{% url 'prospects:prospect_detail' prospect.pk %}" class="btn btn-sm btn-outline-info">View</a>
                                <a href="{% url 'prospects:prospect_edit' prospect.pk %}" class="btn btn-sm btn-outline-warning">Edit</a>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% else %}
        <div class="text-center py-5">
            <h4 class="text-muted">No contacts scheduled</h4>
            <p class="text-muted">
                No prospects are scheduled for contact on {{ selected_date|date:"F d, Y" }}.
            </p>
        </div>
    {% endif %}
</div>

<!-- Quick Links to Other Dates -->
<div class="card mt-4">
    <h5 class="mb-3">Quick Navigation</h5>
    <div class="d-flex gap-2 flex-wrap">
        {% load tz %}
        {% now "Y-m-d" as today %}
        <a href="{% url 'prospects:contact_schedule' %}?date={{ today }}" class="btn btn-outline-info btn-sm">Today</a>
        <!-- Add more quick links as needed -->
    </div>
</div>
{% endblock %}
